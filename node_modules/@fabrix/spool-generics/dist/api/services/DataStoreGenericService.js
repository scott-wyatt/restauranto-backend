"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const common_1 = require("@fabrix/fabrix/dist/common");
const validator_1 = require("../../validator");
class DataStoreGenericService extends common_1.FabrixService {
    _init(generic) {
        const Adapter = generic ? generic.adapter : this.app.config.get('generics.data_store_provider.adapter');
        return new Adapter(this.app, generic ? generic.config : this.app.config.get('generics.data_store_provider.config'));
    }
    upload(buffer, adapter) {
        return validator_1.Validator.validateDataStoreProvider.upload(buffer)
            .then(values => {
            adapter = this._init(adapter);
            return adapter.upload(buffer)
                .then(response => {
                return validator_1.Validator.validateDataStoreProvider.uploadSuccess(response);
            });
        });
    }
    uploadFile(file, adapter) {
        return validator_1.Validator.validateDataStoreProvider.uploadFile(file)
            .then(values => {
            adapter = this._init(adapter);
            return adapter.uploadFile(file)
                .then(response => {
                return validator_1.Validator.validateDataStoreProvider.uploadFileSuccess(response);
            });
        });
    }
    uploadFiles(files, adapter) {
        return validator_1.Validator.validateDataStoreProvider.uploadFiles(files)
            .then(values => {
            adapter = this._init(adapter);
            return adapter.uploadFiles(files)
                .then(responses => {
                return validator_1.Validator.validateDataStoreProvider.uploadFilesSuccess(responses);
            });
        });
    }
}
exports.DataStoreGenericService = DataStoreGenericService;
