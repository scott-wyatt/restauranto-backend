"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const common_1 = require("@fabrix/fabrix/dist/common");
const winston = require("winston");
const config = require("./config/index");
const pkg = require("../package.json");
const api = require("./api/index");
class WinstonSpool extends common_1.Spool {
    bindEvents() {
        this.app.removeAllListeners('fabrix:log');
        this.app.on('fabrix:log', (level, msg = []) => this.logger.log(level, ...msg));
    }
    constructor(app) {
        super(app, {
            config: config,
            pkg: pkg,
            api: api
        });
        app.once('fabrix:constructed', () => {
            this.logger = winston.createLogger(this.app.config.get('log'));
            this.bindEvents();
        });
    }
}
exports.WinstonSpool = WinstonSpool;
